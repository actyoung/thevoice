import{_ as g,r as h,q as E,d as c,e as _,f as s,F as C,s as B,t as y,k as m,i as l,w as d,v as L,x as S,m as k,o as I,y as j,z,A as N,u as A,j as F,h as w,B as x,C as $,n as M}from"./index-Bat2jzID.js";/* empty css                  */const U={class:"form-container"},q={class:"character-list"},D={class:"character-title"},O={class:"form-label"},T={__name:"CharacterList",props:["characters"],emits:["submitVote"],setup(v,{emit:b}){const V=v,i=b,r=h({});E(()=>V.characters,e=>{e.forEach(n=>{r.value[n.id]={score:0}})},{immediate:!0});const p=e=>{r.value[e].score>100&&(r.value[e].score=100,L.error("评分不能超过100分"))},a=()=>{const e=Object.values(r.value);i("submitVote",e)};return(e,n)=>{const u=S,t=k;return c(),_("div",U,[s("div",q,[(c(!0),_(C,null,B(v.characters,o=>(c(),_("div",{key:o.id,class:"character-card"},[s("h3",D,y(o.name),1),s("label",O,[n[0]||(n[0]=m(" 评分: ")),l(u,{modelValue:r.value[o.id].score,"onUpdate:modelValue":f=>r.value[o.id].score=f,min:0,max:100,onChange:f=>p(o.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]))),128))]),l(t,{type:"primary",onClick:a,class:"submit-button"},{default:d(()=>n[1]||(n[1]=[m("提交投票")])),_:1})])}}},G=g(T,[["__scopeId","data-v-469934c0"]]),H={class:"leaderboard-container"},J={class:"leaderboard-item"},K={class:"leaderboard-item"},P={__name:"LeaderBoard",props:["votes"],emits:["resetVote"],setup(v,{emit:b}){const V=v,i=b;I(()=>{const{reward:a}=j.useReward("full-page","confetti",{startVelocity:10,spread:180,elementCount:100,zIndex:1e3,onAnimationComplete:()=>{a()}});a()});const r=z(()=>[...V.votes].sort((a,e)=>e.score-a.score)),p=()=>{i("resetVote")};return(a,e)=>{const n=N,u=k;return c(),_(C,null,[e[3]||(e[3]=s("div",{id:"full-page"},null,-1)),s("div",H,[e[2]||(e[2]=s("h2",null,"排行榜",-1)),l(n,{class:"leaderboard"},{default:d(()=>[e[0]||(e[0]=s("div",{class:"leaderboard-header"},[s("div",{class:"header-item"},"角色名"),s("div",{class:"header-item"},"评分")],-1)),(c(!0),_(C,null,B(r.value,(t,o)=>(c(),_("div",{key:o,class:"leaderboard-row"},[s("div",J,y(t.characterName),1),s("div",K,y(t.score),1)]))),128))]),_:1}),l(u,{type:"primary",onClick:p,class:"reset-button"},{default:d(()=>e[1]||(e[1]=[m("重新投票")])),_:1})])],64)}}},Q=g(P,[["__scopeId","data-v-c3c9be3f"]]),W={class:"rating-view"},X={class:"video-title"},Y={class:"button-group"},Z={__name:"RatingView",setup(v){const b=F(),i=A().getVideoById(b.params.id),r=h(i.characters),p=h([]),a=h(!1),e=u=>{p.value=r.value.map((t,o)=>({characterName:t.name,studentName:u[o].studentName,score:u[o].score})),a.value=!0},n=()=>{a.value=!1};return(u,t)=>{const o=k,f=M("RouterLink"),R=N;return c(),_("div",W,[l(R,{class:"card-container"},{default:d(()=>[s("h2",null,[t[0]||(t[0]=m("给 ")),s("span",X,y(w(i).title),1),t[1]||(t[1]=m(" 的表演投票"))]),a.value?$("",!0):(c(),x(G,{key:0,characters:r.value,onSubmitVote:e,class:"character-list"},null,8,["characters"])),a.value?(c(),x(Q,{key:1,votes:p.value,onResetVote:n,class:"leaderboard"},null,8,["votes"])):$("",!0),s("div",Y,[l(f,{to:`/video/${w(i).id}`},{default:d(()=>[l(o,{type:"primary",class:"action-button"},{default:d(()=>t[2]||(t[2]=[m("返回上一页")])),_:1})]),_:1},8,["to"]),l(f,{to:"/"},{default:d(()=>[l(o,{type:"success",class:"action-button"},{default:d(()=>t[3]||(t[3]=[m("返回首页")])),_:1})]),_:1})])]),_:1})])}}},se=g(Z,[["__scopeId","data-v-c9ce7c89"]]);export{se as default};
